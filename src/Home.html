<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biblioteca Virtual - Home</title>
    <link rel="stylesheet" href="./styles.css">
    <style>
        /* Estilos especificos da Home */
        .livro-card {
            background: var(--white);
            border-radius: var(--radius);
            padding: 1rem;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .livro-card img {
            width: 100%;
            height: 280px;
            object-fit: cover;
            border-radius: var(--radius-sm);
            margin-bottom: 1rem;
        }

        .livro-card-tag {
            position: absolute;
            top: 1rem;
            left: 1rem;
            z-index: 10;
        }

        .recomendacao-item {
            background: var(--white);
            padding: 1rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            display: flex;
            gap: 1rem;
            transition: var(--transition);
        }

        .recomendacao-item:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
        }

        .recomendacao-capa {
            width: 80px;
            height: 100px;
            border-radius: var(--radius-sm);
            overflow: hidden;
            flex-shrink: 0;
        }

        .recomendacao-capa img, .recomendacao-capa image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .recomendacao-info {
            flex: 1;
        }

        .recomendacao-info h3 {
            font-size: 0.9rem;
            color: var(--accent);
            margin-bottom: 0.25rem;
        }

        .recomendacao-info p {
            font-size: 0.85rem;
            color: var(--gray-600);
            margin-bottom: 0.5rem;
        }

        .recomendacao-info span {
            margin-right: 0.5rem;
            margin-bottom: 0.25rem;
        }

        .tag-novo { background: var(--accent); color: white; }
        .tag-popular { background: var(--warning); color: white; }
        .tag-classico { background: var(--primary); color: white; }
        .tag-destaque { background: var(--success); color: white; }

    </style>
</head>
<body>

    <header>
        <h1>Biblioteca Virtual</h1>
        <nav>
            <ul>
                <li><a href="./Home.html">Home</a></li>
                <li><a href="./catálogodelivros.html">Acervo</a></li>
                <li><a href="./favoritos.html">Salvos</a></li>
                <li><a href="./catálogodelivros.html">Expert Reader</a></li>
                <li>
                    <div class="search-container">
                        <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.3-4.3"></path>
                        </svg>
                        <input type="text" id="searchInput" placeholder="Pesquisar">
                    </div>
                </li>
            </ul>
        </nav>
    </header>

    <section class="hero-banner">
        <h1>Bem-vindo à Biblioteca Virtual</h1>
        <p>Explore uma vasta coleção de livros e recomendações personalizadas.</p>
        <button>Começar a Ler</button>
    </section>

    <section class="content-section">
        <h2 class="section-heading">Continuar leitura</h2>
        <div class="continuar-leitura" id="continuar-leitura">
            <!-- Carregado dinamicamente -->
        </div>
    </section>

    <section class="content-section">
        <h2 class="section-heading">Expert Reader - Recomendações</h2>
        <div class="recomendacoes-grid" id="recomendacoes">
            <!-- Carregado dinamicamente -->
        </div>
    </section>

    <section class="content-section">
        <h2 class="section-heading">Todos os Livros</h2>
        <div class="livros-grid" id="todos-livros">
            <!-- Carregado dinamicamente -->
        </div>
    </section>

    <footer class="footer">
        <div class="footer-links">
            <a href="#">Sobre nós</a>
            <a href="#">Política de Privacidade</a>
            <a href="#">Termos de Uso</a>
            <a href="#">Contacte-Nos</a>
        </div>
    </footer>

    <!-- Scripts centralizados -->
    <script src="./dados.js"></script>
    <script src="./app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Funcao para criar card de livro
            function criarCardLivro(livro, tipo = 'card') {
                const autor = BIBLIOTECA.getAutorById(livro.autorId);
                const div = document.createElement('div');

                if (tipo === 'card') {
                    div.className = 'livro-card';
                    div.innerHTML = `
                        <img src="${livro.capa}" alt="${livro.titulo}">
                        <span class="livro-card-tag">${livro.genero}</span>
                        <h3>${livro.titulo}</h3>
                        <p>${autor ? autor.nome : 'Autor desconhecido'}</p>
                    `;
                } else if (tipo === 'recomendacao') {
                    div.className = 'recomendacao-item';
                    div.innerHTML = `
                        <div class="recomendacao-capa">
                            <img src="${livro.capa}" alt="${livro.titulo}">
                        </div>
                        <div class="recomendacao-info">
                            <h3>${livro.titulo}</h3>
                            <p>${livro.descricao.substring(0, 100)}...</p>
                            ${livro.tags.slice(0, 2).map(tag => `<span class="tag-${tag.toLowerCase().includes('novo') ? 'novo' : tag.toLowerCase().includes('clássico') ? 'classico' : 'popular'}">${tag}</span>`).join(' ')}
                            <p>${autor ? autor.nome : ''}</p>
                        </div>
                    `;
                } else if (tipo === 'mini') {
                    div.className = 'livro-card';
                    div.innerHTML = `
                        <img src="${livro.capa}" alt="${livro.titulo}">
                        <h3>${livro.titulo}</h3>
                        <p>${autor ? autor.nome : ''}</p>
                    `;
                }

                div.style.cursor = 'pointer';
                div.addEventListener('click', () => APP.irParaLivro(livro.id));
                return div;
            }

            // Carregar Continuar Leitura (primeiros 3 livros ou livros em progresso)
            const continuarContainer = document.getElementById('continuar-leitura');
            const livrosEmLeitura = PROGRESSO.getLivrosEmLeitura();

            if (livrosEmLeitura.length > 0) {
                livrosEmLeitura.slice(0, 3).forEach(item => {
                    if (item.livro) {
                        continuarContainer.appendChild(criarCardLivro(item.livro, 'card'));
                    }
                });
            } else {
                // Mostrar livros populares se nao houver em leitura
                [1, 2, 3].forEach(id => {
                    const livro = BIBLIOTECA.getLivroById(id);
                    if (livro) continuarContainer.appendChild(criarCardLivro(livro, 'card'));
                });
            }

            // Carregar Recomendacoes
            const recomendacoesContainer = document.getElementById('recomendacoes');
            [9, 10, 11].forEach(id => {
                const livro = BIBLIOTECA.getLivroById(id);
                if (livro) recomendacoesContainer.appendChild(criarCardLivro(livro, 'recomendacao'));
            });

            // Carregar Todos os Livros
            const todosContainer = document.getElementById('todos-livros');
            BIBLIOTECA.livros.forEach(livro => {
                todosContainer.appendChild(criarCardLivro(livro, 'mini'));
            });

            // Navegacao do menu
            document.querySelectorAll('header nav a').forEach(link => {
                link.addEventListener('click', (e) => {
                    const texto = link.textContent.trim().toLowerCase();
                    if (texto === 'home' || texto === 'acervo' || texto === 'salvos' || texto === 'expert reader') {
                        e.preventDefault();
                        if (texto === 'home') APP.irParaHome();
                        else if (texto === 'acervo') APP.irParaCatalogo();
                        else if (texto === 'salvos') APP.irParaFavoritos();
                        else if (texto === 'expert reader') APP.irParaCatalogo();
                    }
                });
            });

            // Botao comecar a ler
            const btnComecar = document.querySelector(".hero-banner button");
            if (btnComecar) {
                btnComecar.addEventListener("click", () => APP.irParaCatalogo());
            }

            // Busca
            const inputBusca = document.getElementById("searchInput");
            if (inputBusca) {
                inputBusca.addEventListener("keypress", (e) => {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        const termo = inputBusca.value.trim();
                        if (termo) APP.realizarBusca(termo);
                    }
                });
            }

            // Footer links
            const footerLinks = document.querySelectorAll(".footer-links a");
            footerLinks[0]?.addEventListener("click", (e) => { e.preventDefault(); alert("Sobre nós: A Biblioteca Virtual oferece acesso rápido e fácil a uma vasta coleção de livros."); });
            footerLinks[1]?.addEventListener("click", (e) => { e.preventDefault(); alert("Política de Privacidade: Suas informações são protegidas."); });
            footerLinks[2]?.addEventListener("click", (e) => { e.preventDefault(); alert("Termos de Uso: Ao usar a biblioteca, você concorda em respeitar os direitos autorais."); });
            footerLinks[3]?.addEventListener("click", (e) => { e.preventDefault(); alert("Contato: suporte@bibliotecavirtual.com"); });
        });
    </script>
</body>
</html>
