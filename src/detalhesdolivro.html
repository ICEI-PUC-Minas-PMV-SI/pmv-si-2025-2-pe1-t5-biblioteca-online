<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhe do Livro</title>
    <link rel="stylesheet" href="detalhesdolivro.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
</head>
<body>

    <header>
        <h1>Biblioteca Virtual</h1>
        <nav>
            <ul>
                <li><a href="./Home.html">Home</a></li>
                <li><a href="./catálogodelivros.html">Acervo</a></li>
                <li><a href="./favoritos.html">Salvos</a></li>
                <li><a href="./catálogodelivros.html">Expert Reader</a></li>
                <li>
                    <div class="search-container">
                        <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.3-4.3"></path>
                        </svg>
                        <input type="text" id="searchInput" placeholder="Pesquisar">
                    </div>
                </li>
            </ul>
        </nav>
    </header>

    <main class="main-content">
        
        <section class="book-details">
            <div class="maincover-book">
                <span>Capa do livro</span>
            </div>
            <div class="info-livro">
                <h1>Título do Livro</h1>
                <p>Informações completas sobre este livro incrível.</p>
                <div class="tags">
                    <span class="tag">Fantasia</span>
                    <span class="tag">Aventura</span>
                    <span class="tag">Ficção Científica</span>
                </div>
                <div class="tab-container">
                    <div class="tags">
                        <span class="tag active-tag" data-tab="descricao">Descrição</span>
                        <span class="tag" data-tab="avaliacoes">Avaliações</span>
                        <span class="tag" data-tab="detalhes">Detalhes</span>
                    </div>

                    <div id="descricao" class="tab-content active-content">
                        <h5>Uma jornada fascinante.</h5>
                        <p>Este livro nos conduz através de uma narrativa intrigante, cheia de reviravoltas e personagens cativantes. Uma leitura obrigatória para amantes de fantasia.</p>
                    </div>
                    <div id="avaliacoes" class="tab-content">
                        <h5>O que os leitores dizem:</h5>
                        <p>"Simplesmente incrível! Não consegui parar de ler." - Leitor 1</p>
                        <p>"Uma obra-prima da ficção moderna." - Crítico Literário</p>
                    </div>
                    <div id="detalhes" class="tab-content">
                        <h5>Informações Técnicas:</h5>
                        <p><strong>Páginas:</strong> 320</p>
                        <p><strong>Editora:</strong> Editora Fantástica</p>
                        <p><strong>Ano de Publicação:</strong> 2025</p>
                    </div>
            </div>
        </section>

        <section class="author-review">
            <a href="#" class="card-author">
                <div class="image-author"></div>
                <div class="info-author">
                    <h3 class="author">Autor</h3>
                    <p class="name">Nome do Autor</p>
                </div>
            </a>
            <div class="card-rating">
                <div class="image-card-rating"></div>
                <div class="info-card-rating">
                    <h3 class="label">Avaliação</h3>
                    <div class="stars">
                        <span>★</span>
                        <span>★</span>
                        <span>★</span>
                        <span>★</span>
                        <span class="empty">★</span>
                    </div>
                </div>
            </div>
        </section>

        <section class="actions">
            <h2>Ações</h2>
            <div class="list-actions">
                <button class="card-action">
                    <div class="icon-action">
                        <i data-feather="bookmark"></i>
                    </div>
                    <p>Ler Mais Tarde</p>
                </button>
                <button class="card-action">
                    <div class="icon-action">
                        <i data-feather="book-open"></i>
                    </div>
                    <p>Ler Agora</p>
                </button>
                <button class="card-action">
                    <div class="icon-action">
                        <i data-feather="edit-3"></i>
                    </div>
                    <p>Estudos</p>
                </button>
            </div>
        </section>

        <section class="more-books">
            <h2>Mais livros do autor</h2>
            <div class="list-books">
                <button class="card-book">
                    <div class="bookcover-others"><span>Capa Livro 1</span></div>
                    <p>Livro 1</p>
                </button>
                <button class="card-book">
                    <div class="bookcover-others"><span>Capa Livro 2</span></div>
                    <p>Livro 2</p>
                </button>
                <button class="card-book">
                    <div class="bookcover-others"><span>Capa Livro 3</span></div>
                    <p>Livro 3</p>
                </button>
            </div>
        </section>

    </main>

    <footer class="footer">
        <a href="#">Sobre nós</a>
        <a href="#">Política de Privacidade</a>
        <a href="#">Termos de Uso</a>
        <a href="#">Contacte-Nos</a>
    </footer>





    <!-- Scripts centralizados -->
    <script src="./dados.js"></script>
    <script src="./app.js"></script>
    <script>
    feather.replace();

    document.addEventListener('DOMContentLoaded', () => {
        // Carregar dados do livro pela URL
        const livroId = APP.getParametroURL('id') || 1;
        const livro = BIBLIOTECA.getLivroById(livroId);
        const autor = livro ? BIBLIOTECA.getAutorById(livro.autorId) : null;

        if (livro) {
            // Atualizar titulo e info
            document.querySelector('.info-livro h1').textContent = livro.titulo;
            document.querySelector('.info-livro > p').textContent = livro.descricao;
            document.title = `${livro.titulo} - Biblioteca Virtual`;

            // Atualizar capa
            const capaDiv = document.querySelector('.maincover-book');
            capaDiv.innerHTML = `<img src="${livro.capa}" alt="${livro.titulo}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">`;

            // Atualizar tags
            const tagsDiv = document.querySelector('.info-livro .tags');
            tagsDiv.innerHTML = livro.tags.map(tag => `<span class="tag">${tag}</span>`).join('');

            // Atualizar descricao
            document.querySelector('#descricao p').textContent = livro.descricao;

            // Atualizar detalhes
            document.querySelector('#detalhes').innerHTML = `
                <h5>Informações Técnicas:</h5>
                <p><strong>Páginas:</strong> ${livro.paginas}</p>
                <p><strong>Ano de Publicação:</strong> ${livro.ano}</p>
                <p><strong>Gênero:</strong> ${livro.genero}</p>
            `;

            // Atualizar autor
            if (autor) {
                document.querySelector('.name').textContent = autor.nome;
                const autorCard = document.querySelector('.card-author');
                autorCard.style.cursor = 'pointer';
                autorCard.addEventListener('click', (e) => {
                    e.preventDefault();
                    APP.irParaAutor(autor.id);
                });

                // Foto do autor
                const fotoAutor = document.querySelector('.image-author');
                fotoAutor.style.backgroundImage = `url(${autor.foto})`;
                fotoAutor.style.backgroundSize = 'cover';
                fotoAutor.style.backgroundPosition = 'center';
            }

            // Atualizar estrelas
            const starsContainer = document.querySelector('.stars');
            starsContainer.innerHTML = '';
            for (let i = 0; i < 5; i++) {
                const span = document.createElement('span');
                span.textContent = '★';
                if (i >= livro.avaliacao) span.classList.add('empty');
                starsContainer.appendChild(span);
            }

            // Mais livros do autor
            if (autor) {
                const outrosLivros = BIBLIOTECA.getLivrosByAutorId(autor.id).filter(l => l.id !== livro.id);
                const listBooks = document.querySelector('.list-books');
                listBooks.innerHTML = '';

                outrosLivros.slice(0, 3).forEach(outroLivro => {
                    const btn = document.createElement('button');
                    btn.className = 'card-book';
                    btn.innerHTML = `
                        <div class="bookcover-others" style="background-image: url(${outroLivro.capa}); background-size: cover; background-position: center;">
                        </div>
                        <p>${outroLivro.titulo}</p>
                    `;
                    btn.addEventListener('click', () => APP.irParaLivro(outroLivro.id));
                    listBooks.appendChild(btn);
                });

                if (outrosLivros.length === 0) {
                    listBooks.innerHTML = '<p>Nenhum outro livro deste autor no catálogo.</p>';
                }
            }
        }

        // Botoes de acao
        const botoesAcao = document.querySelectorAll('.list-actions .card-action');
        const acoes = ['lerDepois', 'ler', 'estudos'];

        botoesAcao.forEach((botao, index) => {
            botao.addEventListener('click', () => {
                const acao = acoes[index];

                if (acao === 'ler') {
                    APP.irParaLeitura(livroId);
                    return;
                }

                const estaAtivo = botao.classList.contains('active');
                if (estaAtivo) {
                    botao.classList.remove('active');
                    botao.querySelector('p').textContent = botao.dataset.originalText;
                } else {
                    botao.classList.add('active');
                    botao.dataset.originalText = botao.querySelector('p').textContent;
                    botao.querySelector('p').textContent = 'Adicionado!';

                    if (acao === 'lerDepois') FAVORITOS.addLerDepois(parseInt(livroId));
                    if (acao === 'estudos') FAVORITOS.addEstudos(parseInt(livroId));
                }
            });
        });

        // Navegacao
        document.querySelectorAll('.menu a').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const texto = link.textContent.trim().toLowerCase();
                if (texto === 'home') APP.irParaHome();
                else if (texto === 'acervo') APP.irParaCatalogo();
                else if (texto === 'salvos') APP.irParaFavoritos();
                else if (texto === 'expert reader') APP.irParaCatalogo();
            });
        });

        // Busca
        const searchInput = document.getElementById('searchInput');
        if (searchInput) {
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const termo = searchInput.value.trim();
                    if (termo) APP.realizarBusca(termo);
                }
            });
        }

        // Sistema de Abas
        const abas = document.querySelectorAll('.tab-container .tags .tag');
        abas.forEach(aba => {
            aba.addEventListener('click', () => {
                const targetId = aba.dataset.tab;
                const targetContent = document.getElementById(targetId);
                abas.forEach(a => a.classList.remove('active-tag'));
                aba.classList.add('active-tag');
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active-content');
                });
                if (targetContent) targetContent.classList.add('active-content');
            });
        });
    });
    </script>
</body>
</html>
